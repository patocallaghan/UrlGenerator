(function(a,b){var c={};c.UrlGenerator=function(){function f(){a.find(".btn").on("click",j),a.find("input").on("keypress",k),a.find(".close").on("click",h),b(document).on("keyup",i)}function g(){a.show(),b(document).on("keyup",i)}function h(c){c.preventDefault(),a.hide(),b(document).off("keyup",i)}function i(b){b.keyCode==27&&a.find(".close").click()}function j(a){a.preventDefault(),r(this)}function k(a){console.log(a.keyCode),a.keyCode===13&&(a.preventDefault(),l(this))}function l(b){var d,e=!1,f=!1;c.each(function(){var a=this.value;if(!a)return!0;this.name==="dev"?e=!0:f=!0});if(e&&f)d="both";else{if(!e&&!f)return!1;d="home"}console.log(f,e,d,a.find("#"+d)),a.find("#"+d).click()}function m(){return b("#terabyte-url").length?g():(b("body").append(d),a=b("#terabyte-url"),c=a.find("input")),b.Deferred(function(a){b("#terabyte-url").length&&b("#terabyte-url:visible").length?a.resolve():a.reject()}).promise()}function n(){return b.get(e.host+"bookmarklet/urlgenerator.html")}function o(a,b,c){return e._URL_START+a+e[b]+e._URL_END+e[c]}function p(a,b){var c="_blank";b||(c="_self"),window.open(a,c)}function q(a){var d,e=[],f=a.id;return c.each(function(){var a=b(this),c=this.name;if(!this.value.length)return!0;f!="both"?e.push(o(this.value,c,f)):(e.push(o(this.value,c,"home")),e.push(o(this.value,c,"admin")))}),e}function r(a){var b=!1,c=q(a);for(var d=0,e=c.length;d<e;d++)p(c[d],b),b||(b=!0)}var a,c,d='<div id="terabyte-url"><fieldset><legend>Terabyte Server URL Generator</legend><label for="dev">Dev URL</label><input type="text" placeholder="Dev" name="dev" /><label for="test">Test URL</label><input type="text" placeholder="Test" name="test" /><div class="buttons"><a class="btn" id="home">Home</a><a class="btn" id="admin">Admin</a><a class="btn btn-wide" id="both">Both</a></div><a class="close">X</a></fieldset></div>',e={_URL_START:"http://www.",_URL_END:".terabyte.co.nz",dev:".dev",test:".test",home:"",admin:"/admin",host:"http://localhost:58012/"};return{init:function(){b.when(m()).then(function(){f()}).fail(function(){console.error("URL generator - HTML not appended!")})},reInit:function(){g()}}}(),a.Terabytelet=c})(window,window.terabyteletLibrary),Terabytelet.UrlGenerator.init()